# PR-0001: Cost Decomposition

**Status:** Active
**Category:** First Principles
**Priority:** Foundational

---

## Principle

**Break problems to material fundamentals: time, money, energy, complexity.**

When analyzing costs, decompose to atomic units that cannot be further broken down.

---

## Rationale

Most cost estimates fail because they:
1. Aggregate too early (lose visibility into drivers)
2. Use analogies instead of fundamentals ("similar project cost $X")
3. Ignore hidden costs (maintenance, operations, opportunity cost)
4. Don't account for uncertainty (buffer, risk)

Cost decomposition from first principles ensures:
- All cost drivers are visible
- Estimates are grounded in reality
- Trade-offs are explicit
- Hidden costs are surfaced

---

## Atomic Cost Units

### 1. Time
- **Development time:** Hours/days of engineering work
- **Review time:** Hours spent in code review, QA
- **Meeting time:** Hours spent in coordination
- **Learning time:** Hours spent onboarding/ramp-up
- **Debug time:** Hours spent fixing issues

**Unit:** Hours (convert to dollars via hourly rate)

### 2. Money
- **Direct costs:** Software licenses, infrastructure, tools
- **Personnel costs:** Salaries, contractor fees
- **Opportunity costs:** What else could we do with this resources?
- **Risk costs:** Probability × Impact of adverse events

**Unit:** Currency ($)

### 3. Energy
- **Cognitive load:** Complexity for team to understand/maintain
- **Coordination overhead:** Communication cost
- **Decision fatigue:** Number of decisions required
- **Technical debt:** Future cost of shortcuts

**Unit:** Relative (low/medium/high) or qualitative

### 4. Complexity
- **Integration points:** Number of external dependencies
- **Moving parts:** Number of services/systems involved
- **Novelty:** How different is this from what we've done before?
- **Uncertainty:** How much is unknown?

**Unit:** Count (integration points) or qualitative (uncertainty)

---

## Cost Decomposition Framework

### Step 1: Decompose the Problem

Break the solution into components:

```
[Solution]
  ├─ Component 1
  │   ├─ Subcomponent 1.1
  │   └─ Subcomponent 1.2
  ├─ Component 2
  │   └─ Subcomponent 2.1
  └─ Component 3
```

### Step 2: Estimate Atomic Costs

For each component, estimate:

| Component | Dev Time | Review Time | Direct Cost | Complexity | Risk |
|-----------|----------|-------------|-------------|------------|------|
| Comp 1.1  | 8h       | 2h          | $0          | Low        | Low  |
| Comp 1.2  | 16h      | 4h          | $100        | Medium     | Med  |
| Comp 2.1  | 4h       | 1h          | $50         | Low        | Low  |

### Step 3: Sum and Apply Multipliers

**Base Cost:** Sum of atomic costs

**Multipliers:**
- **Buffer multiplier:** 1.2x - 1.5x (for uncertainty)
- **Risk multiplier:** +10-30% per high-risk item
- **Maintenance factor:** +20% yearly (for ongoing work)

**Total Cost = (Base Cost × Buffer) + Risk + Maintenance**

### Step 4: Validate Against Reality

- Compare to past projects (sanity check)
- Get independent estimate (reduce bias)
- Check against market rates (are we way off?)

---

## Example: Build Custom Auth vs Use Clerk

### Build Custom Auth (Cost Decomposition)

| Component | Dev Time | Hourly Rate | Cost | Complexity | Risk |
|-----------|----------|-------------|------|------------|------|
| User DB schema | 8h | $100 | $800 | Low | Low |
| Password hashing | 4h | $100 | $400 | Low | Low |
| Session management | 16h | $100 | $1,600 | Medium | Medium |
| Email verification | 8h | $100 | $800 | Low | Low |
| Password reset | 8h | $100 | $800 | Low | Low |
| MFA implementation | 24h | $100 | $2,400 | High | High |
| SOC2 compliance | 40h | $150 | $6,000 | High | Critical |
| Security audit | - | - | $20,000 | - | - |
| Documentation | 16h | $100 | $1,600 | Low | Low |
| **TOTAL** | **124h** | - | **$33,600** | - | - |

**Multipliers:**
- Buffer (1.3x for security uncertainty): $33,600 × 1.3 = $43,680
- Risk (SOC2 high risk): +20% = $52,416
- Maintenance (20% yearly): +$10,483/year

**Year 1 Total: $52,416**
**Years 2-5: $10,483/year**

**5-Year TCO: $52,416 + ($10,483 × 4) = $94,348**

---

### Clerk (Cost Decomposition)

| Component | Dev Time | Hourly Rate | Cost | Complexity | Risk |
|-----------|----------|-------------|------|------------|------|
| Setup account | 1h | $100 | $100 | Trivial | None |
| Install SDK | 2h | $100 | $200 | Trivial | None |
| Basic auth flows | 8h | $100 | $800 | Low | Low |
| Custom styling | 8h | $100 | $800 | Low | Low |
| **TOTAL** | **19h** | - | **$1,900** | - | - |

**Multipliers:**
- Buffer (1.2x, low risk): $1,900 × 1.2 = $2,280
- Risk (minimal): +0%
- License: $8,000/year
- Maintenance: Included in license

**Year 1 Total: $2,280 + $8,000 = $10,280**
**Years 2-5: $8,000/year**

**5-Year TCO: $10,280 + ($8,000 × 4) = $42,280**

---

### Comparison

| Option | Year 1 | Years 2-5 | 5-Year TCO |
|--------|--------|-----------|------------|
| Build Custom | $52,416 | $10,483/yr | $94,348 |
| Clerk | $10,280 | $8,000/yr | $42,280 |

**Savings with Clerk: $52,068 over 5 years**

**Decision:** Clerk based on cost decomposition

---

## Common Pitfalls

### ❌ Don't:
- Use analogy ("similar project cost $50k")
- Aggregate too early ("backend will cost $20k")
- Ignore hidden costs (maintenance, operations)
- Forget to account for risk and uncertainty
- Use hourly rates without considering productivity variations

### ✅ Do:
- Decompose to atomic units (hours, dollars, complexity points)
- Estimate each component independently
- Include all cost drivers (dev, review, QA, maintenance)
- Apply buffers and risk multipliers
- Validate estimates against reality

---

## When to Use

Use cost decomposition for:
- Architecture decisions (build vs buy)
- Technology choices (framework A vs B)
- Project planning (is this worth doing?)
- Resource allocation (how many engineers?)
- Make vs buy decisions
- Vendor selection

---

## Related Principles

- **PR-0002:** ADI Cycle - Use cost decomposition in abduction phase
- **PR-0003:** Transformer Mandate - AI generates cost breakdown, human validates

---

## Examples in Codebase

See:
- `runtime/fp_engine/first_principles.py` - `cost_analysis()` method
- `.docs/first-principles/README.md` - Build vs buy example

---

**Last Updated:** 2026-01-13
**Author:** Blackbox3 First Principles System
